<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<form method="post" id = "playGameForm" action="/playGame">
<!--    <input type="submit" id="playGameButton" value="Play in Game"/>-->
</form>

<form method="post" action="/tableHighScore">
    <input type="submit" id="highScoreButton" value="High Score"/>
</form>

<script>
    let request = new XMLHttpRequest();
    let tgParam = window.Telegram.WebApp;
    let id = tgParam.initDataUnsafe.user.id.toString();
    let first_name = tgParam.initDataUnsafe.user.first_name;
    let username = tgParam.initDataUnsafe.user.username;

    request.open("POST", "/searchInDb", true);
    request.setRequestHeader("Content-Type", "application/json");
    request.send(JSON.stringify({
        id:id,
        first_name:first_name,
        username:username
    }));

    localStorage.setItem('id',id)
    localStorage.setItem('first_name',first_name)
    localStorage.setItem('username',username)

    let MainButton = tgParam.MainButton;
    MainButton.text = "Play in Chess"
    MainButton.show();

    MainButton.onClick(function (){
        // request.open("GET", "/playGame", true);
        // request.setRequestHeader("Content-Type", "application/json");
        // request.send();

        window.location.href = "./gamePage.html";
    })

</script>
</body>
</html>